<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Finance Dashboard</title>
    <style>
      :root{
        --bg:#ffffff;
        --text:#0f172a;
        --muted:#64748b;
        --border:#e5e7eb;
        --card:#ffffff;
        --shadow: 0 10px 25px rgba(2,6,23,.06);
        --radius:14px;
      }
      *{box-sizing:border-box}
      body{
        margin:0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
        color:var(--text);
        background:var(--bg);
      }
      body.auth-only{
        min-height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
      }
      body.auth-only .wrap{width:100%}
      body.auth-only #auth{margin:0 auto}
      a{color:inherit; text-decoration:none}
      .wrap{max-width:1040px; margin:0 auto; padding:28px 22px 60px;}
      /* top nav */
      .topbar{
        display:flex; align-items:center; justify-content:center;
        gap:26px; color:var(--muted);
        font-size:14px;
        margin-top:8px;
      }
      .topbar a{padding:6px 8px; border-radius:10px}
      .topbar a.active{color:var(--text); font-weight:600}
      .topbar-logout{
        margin-left:auto;
        padding:6px 10px;
        border:1px solid var(--border);
        border-radius:10px;
        background:#fff;
        font-size:12px;
        font-weight:600;
        cursor:pointer;
      }
      /* header row */
      .header{
        display:flex; align-items:center; justify-content:space-between;
        margin:40px 0 18px;
      }
      .header-right{
        display:flex;
        align-items:center;
        gap:12px;
      }
      .today-date{
        font-size:12px;
        color:var(--muted);
        font-weight:600;
        text-transform:capitalize;
      }
      .back{
        font-size:14px; color:var(--muted); font-weight:600;
      }
      .kebab{
        width:36px; height:36px; border:1px solid var(--border);
        border-radius:999px; display:grid; place-items:center;
        background:#fff;
      }
      .kebab span{letter-spacing:2px; transform:translateY(-1px)}
      /* main grid */
      .grid{
        display:grid;
        grid-template-columns: 330px 1fr;
        gap:16px;
        align-items:stretch;
      }

      .bankcard{
        border-radius:18px;
        padding:18px 18px;
        color:#eef2ff;
        min-height:150px;
        box-shadow: var(--shadow);
        border:1px solid rgba(255,255,255,.18);
        background:
          radial-gradient(1100px 500px at 30% 120%, rgba(37,99,235,.85), transparent 60%),
          radial-gradient(700px 400px at 85% 20%, rgba(16,185,129,.55), transparent 60%),
          linear-gradient(135deg, rgba(15,23,42,.70), rgba(15,23,42,.35));
        position:relative;
        overflow:hidden;
      }
      .bankcard .name{font-size:12px; opacity:.95}
      .bankcard .iban{font-size:12px; opacity:.85; margin-top:2px}
      .rings{
        position:absolute; right:18px; bottom:16px;
        width:92px; height:56px;
      }
      .rings:before, .rings:after{
        content:""; position:absolute; width:48px; height:48px;
        border:1.8px solid rgba(255,255,255,.65);
        border-radius:999px; top:6px;
      }
      .rings:before{left:10px}
      .rings:after{left:36px}

      .stats{
        display:grid;
        grid-template-columns: repeat(3, 1fr);
        grid-auto-rows:minmax(84px, auto);
        gap:12px;
      }
      .stat{
        background:var(--card);
        border:1px solid var(--border);
        border-radius:12px;
        padding:12px 12px;
        box-shadow: 0 6px 18px rgba(2,6,23,.04);
      }
      .stat .label{font-size:12px; color:var(--muted); font-weight:600}
      .stat .value{font-size:22px; font-weight:800; margin-top:6px}
      .stat .hint{font-size:11px; color:var(--muted); margin-top:6px}
      .stat.tall{
        grid-row: span 2;
      }

      /* payments */
      h2{
        margin:26px 0 10px;
        font-size:18px;
      }
      .payments{
        border:1px solid var(--border);
        border-radius:14px;
        overflow:hidden;
        background:#fff;
        box-shadow: 0 6px 18px rgba(2,6,23,.04);
      }
      .payments.carousel{
        padding:8px 0;
      }
      .carousel-track{
        display:flex;
        flex-direction:column;
        gap:12px;
        padding:6px 12px;
        max-height:420px;
        overflow-y:auto;
      }
      .carousel-track::-webkit-scrollbar{width:8px}
      .carousel-track::-webkit-scrollbar-thumb{background:#e5e7eb; border-radius:999px}
      .row{
        display:grid;
        grid-template-columns: 44px minmax(0, 1fr) 140px;
        align-items:center;
        gap:8px;
        padding:12px 14px;
        border-top:1px solid var(--border);
      }
      .row:first-child{border-top:none}
      .icon{
        width:34px; height:34px;
        border-radius:10px;
        display:grid; place-items:center;
        font-weight:700;
        border:1px solid var(--border);
        background:#fff;
      }
      .titleline{
        display:flex; align-items:baseline; gap:8px; min-width:0;
      }
      .title{
        font-weight:700;
        font-size:13px;
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }
      .sub{
        font-size:12px;
        color:var(--muted);
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }
      .provider{
        font-size:12px;
        color:var(--muted);
        margin-top:4px;
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }
      .tag{
        display:inline-block;
        font-size:11px;
        padding:2px 7px;
        border:1px solid var(--border);
        color:var(--muted);
        border-radius:999px;
        margin-top:5px;
        width:max-content;
      }
      .amount{
        text-align:right;
      }
      .amount .euro{font-weight:800}
      .amount .when{
        font-size:12px;
        color:var(--muted);
        margin-top:4px;
        white-space:nowrap;
      }
      .payment-card{
        border:1px solid var(--border);
        border-radius:12px;
        box-shadow: 0 6px 18px rgba(2,6,23,.04);
        background:#fff;
        border-top:none;
        width:100%;
      }

      /* responsive */
      @media (max-width: 860px){
        .grid{grid-template-columns:1fr}
        .stats{grid-template-columns: repeat(2, 1fr)}
        .stat.tall{grid-row: auto}
      }
      @media (max-width: 520px){
        .stats{grid-template-columns:1fr}
        .row{grid-template-columns: 44px 1fr 96px}
      }
      /* iOS Safari fix voor knoppen */
button {
  appearance: none;
  -webkit-appearance: none;
  font-size: 16px; /* cruciaal voor iPhone */
  line-height: 1.2;
  color: #0f172a;
}
    </style>
  </head>

  <body>
    <div class="wrap">
            <section id="auth" style="max-width:420px; margin:0 auto 18px; border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow: 0 6px 18px rgba(2,6,23,.04);">
        <h2 style="margin:0 0 10px; font-size:16px;">Inloggen</h2>

        <form id="loginForm" style="display:grid; gap:10px;">
          <label style="display:grid; gap:6px; font-size:12px; color:var(--muted);">
            E-mail
            <input id="email" type="email" required style="padding:10px 12px; border:1px solid var(--border); border-radius:10px; font-size:14px;">
          </label>

          <label style="display:grid; gap:6px; font-size:12px; color:var(--muted);">
            Wachtwoord
            <input id="password" type="password" required minlength="8" style="padding:10px 12px; border:1px solid var(--border); border-radius:10px; font-size:14px;">
          </label>

          <button type="submit" style="padding:10px 12px; border:1px solid var(--border); border-radius:10px; font-weight:700; background:#fff; cursor:pointer;">
            Log in
          </button>

          <button id="signupBtn" type="button" style="padding:10px 12px; border:1px solid var(--border); border-radius:10px; font-weight:700; background:#fff; cursor:pointer; display:none;">
            Account maken
          </button>

          <div id="authMsg" style="font-size:12px; color:var(--muted);"></div>
        </form>
      </section>

      <div id="app" style="display:none;">
        <nav class="topbar" aria-label="Primary">
          <a class="active" href="#">melkic</a>
          <a href="#">finance</a>
          <button id="logoutBtn" type="button" class="topbar-logout">Uitloggen</button>
        </nav>

        <div class="header">
          <a class="back" href="#">Terug naar home</a>
          <div class="header-right">
            <span id="todayDate" class="today-date"></span>
            <button class="kebab" aria-label="Menu">
              <span>Â·Â·Â·</span>
            </button>
          </div>
        </div>

        <section class="grid" aria-label="Overview">
          <div class="bankcard">
            <div class="name">John Doe</div>
            <div class="iban">NL03 INGB 8286 5326 33</div>
            <div class="rings" aria-hidden="true"></div>
          </div>

          <div class="stats">
            <div class="stat">
              <div class="label">Personal Balance</div>
              <div class="value">â‚¬575.00</div>
              <div class="hint">Salary in 12 days</div>
            </div>

            <div class="stat">
              <div class="label">Bills</div>
              <div class="value">â‚¬1175.00</div>
              <div class="hint">Salary in 12 days</div>
            </div>

            <div class="stat tall">
              <div class="label">Other Data</div>
              <div class="value">â‚¬525.00</div>
              <div class="hint">Salary in 12 days</div>
            </div>

            <div class="stat">
              <div class="label">Savings</div>
              <div class="value">â‚¬300.00</div>
              <div class="hint">Salary in 12 days</div>
            </div>

            <div class="stat">
              <div class="label">Groceries &amp; Gas</div>
              <div class="value">â‚¬525.00</div>
              <div class="hint">Salary in 12 days</div>
            </div>
          </div>
        </section>

        <h2>Upcoming Payments</h2>
      <section class="payments carousel" aria-label="Upcoming payments list">
        <div class="carousel-track" id="paymentsTrack">
          <div class="row payment-card" data-day="1">
            <div class="icon" title="Huur">ðŸ’³</div>
            <div>
              <div class="title">Huur</div>
              <div class="provider">Vesteda</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬1737.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Parkeer">ðŸ’³</div>
            <div>
              <div class="title">Parkeer</div>
              <div class="provider">Vesteda</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬199.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="W+K en stroom">ðŸ’³</div>
            <div>
              <div class="title">W+K en stroom</div>
              <div class="provider">Eneco</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬155.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Water">ðŸ’³</div>
            <div>
              <div class="title">Water</div>
              <div class="provider">Evides</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬25.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Afvalstoffenheffing">ðŸ’³</div>
            <div>
              <div class="title">Afvalstoffenheffing</div>
              <div class="provider">Gemeente Rdam</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬37.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Woonverzekering">ðŸ’³</div>
            <div>
              <div class="title">Woonverzekering</div>
              <div class="provider">ING</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬13.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="5">
            <div class="icon" title="Internet thuis">ðŸ’³</div>
            <div>
              <div class="title">Internet thuis</div>
              <div class="provider">KPN</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬57.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="25">
            <div class="icon" title="YouTube Premium">ðŸ’³</div>
            <div>
              <div class="title">YouTube Premium</div>
              <div class="provider">Paypal G</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬34.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="28">
            <div class="icon" title="Motorrijtuigenbelasting">ðŸ’³</div>
            <div>
              <div class="title">Motorrijtuigenbelasting</div>
              <div class="provider">Belastingdienst</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬142.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="30">
            <div class="icon" title="Waterschap">ðŸ’³</div>
            <div>
              <div class="title">Waterschap</div>
              <div class="provider">SVHW</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬42.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="30">
            <div class="icon" title="Autoverzekering">ðŸ’³</div>
            <div>
              <div class="title">Autoverzekering</div>
              <div class="provider">Voogd&amp;voogd</div>
              <div class="tag">Gezamenlijk</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬107.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Aansprakelijkheidsverz">ðŸ’³</div>
            <div>
              <div class="title">Aansprakelijkheidsverz</div>
              <div class="provider">ING</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬7.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="1">
            <div class="icon" title="Uitvaartverzekering">ðŸ’³</div>
            <div>
              <div class="title">Uitvaartverzekering</div>
              <div class="provider">Monuta</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬8.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="2">
            <div class="icon" title="iCloud+ duo">ðŸ’³</div>
            <div>
              <div class="title">iCloud+ duo</div>
              <div class="provider">PayPal G.</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬10.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="10">
            <div class="icon" title="Spotify duo">ðŸ’³</div>
            <div>
              <div class="title">Spotify duo</div>
              <div class="provider">iDeal G.</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬18.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="16">
            <div class="icon" title="OneDrive opslag">ðŸ’³</div>
            <div>
              <div class="title">OneDrive opslag</div>
              <div class="provider">iDeal?</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬2.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="23">
            <div class="icon" title="Saga spaar">ðŸ’³</div>
            <div>
              <div class="title">Saga spaar</div>
              <div class="provider">â€”</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬20.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="23">
            <div class="icon" title="ChatGPT">ðŸ’³</div>
            <div>
              <div class="title">ChatGPT</div>
              <div class="provider">Paypal G.</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬23.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="27">
            <div class="icon" title="Adobe Student">ðŸ’³</div>
            <div>
              <div class="title">Adobe Student</div>
              <div class="provider">iDeal G.</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬20.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="27">
            <div class="icon" title="Oura">ðŸ’³</div>
            <div>
              <div class="title">Oura</div>
              <div class="provider">PayPal G.</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬6.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="27">
            <div class="icon" title="Zorgverzekering">ðŸ’³</div>
            <div>
              <div class="title">Zorgverzekering</div>
              <div class="provider">VGZ</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬170.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="30">
            <div class="icon" title="Telefoonabonnement">ðŸ’³</div>
            <div>
              <div class="title">Telefoonabonnement</div>
              <div class="provider">KPN</div>
              <div class="tag">Emma</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬13.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="2">
            <div class="icon" title="Splice $">ðŸ’³</div>
            <div>
              <div class="title">Splice $</div>
              <div class="provider">Paypal G.</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬15.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="2">
            <div class="icon" title="Uitvaartverzekering">ðŸ’³</div>
            <div>
              <div class="title">Uitvaartverzekering</div>
              <div class="provider">Monuta</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬8.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="5">
            <div class="icon" title="SportCity">ðŸ’³</div>
            <div>
              <div class="title">SportCity</div>
              <div class="provider">iDeal G.</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬30.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="5">
            <div class="icon" title="Melkman.studio $">ðŸ’³</div>
            <div>
              <div class="title">Melkman.studio $</div>
              <div class="provider">Google</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬0.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="25">
            <div class="icon" title="DUO">ðŸ’³</div>
            <div>
              <div class="title">DUO</div>
              <div class="provider">Studieschuld</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬47.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="27">
            <div class="icon" title="Zorgverzekering">ðŸ’³</div>
            <div>
              <div class="title">Zorgverzekering</div>
              <div class="provider">VGZ</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬170.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="28">
            <div class="icon" title="Telefoonabonnement">ðŸ’³</div>
            <div>
              <div class="title">Telefoonabonnement</div>
              <div class="provider">KPN</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬74.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="30">
            <div class="icon" title="Gmail">ðŸ’³</div>
            <div>
              <div class="title">Gmail</div>
              <div class="provider">Paypal G.</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬2.00</div>
              <div class="when"></div>
            </div>
          </div>

          <div class="row payment-card" data-day="30">
            <div class="icon" title="Aansprakelijkheidsverz">ðŸ’³</div>
            <div>
              <div class="title">Aansprakelijkheidsverz</div>
              <div class="provider">Voogd&amp;Voogd</div>
              <div class="tag">Hamza</div>
            </div>
            <div class="amount">
              <div class="euro">â‚¬7.00</div>
              <div class="when"></div>
            </div>
          </div>
        </div>
      </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
    <script>
      // Supabase
      const supabaseUrl = "https://cgeescjioqfmjfgdtlnm.supabase.co";
      const supabaseKey = "sb_publishable_D-zcmoLO_lgpHCGFqxlgrg_xrI9J6T_";
      const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

      // UI refs
      const authSection = document.getElementById("auth");
      const app = document.getElementById("app");
      const loginForm = document.getElementById("loginForm");
      const signupBtn = document.getElementById("signupBtn");
      const logoutBtn = document.getElementById("logoutBtn");
      const authMsg = document.getElementById("authMsg");
      const paymentsTrack = document.getElementById("paymentsTrack");
      const todayDate = document.getElementById("todayDate");

      function setMsg(t) {
        if (authMsg) authMsg.textContent = t || "";
      }

      function setTodayDate() {
        if (!todayDate) return;
        const formatter = new Intl.DateTimeFormat("nl-NL", {
          weekday: "long",
          day: "numeric",
          month: "long",
          year: "numeric"
        });
        todayDate.textContent = formatter.format(new Date());
      }

      function daysUntil(day) {
        const now = new Date();
        const today = now.getDate();
        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
        if (day >= today) return day - today;
        return (daysInMonth - today) + day;
      }

      function formatDueText(days) {
        if (days === 0) return "vandaag";
        if (days === 1) return "betaling over 1 dag";
        return `betaling over ${days} dagen`;
      }

      function sortPayments() {
        if (!paymentsTrack) return;
        const items = Array.from(paymentsTrack.querySelectorAll(".payment-card[data-day]"));
        items.sort((a, b) => {
          const dayA = parseInt(a.getAttribute("data-day"), 10);
          const dayB = parseInt(b.getAttribute("data-day"), 10);
          return daysUntil(dayA) - daysUntil(dayB);
        });
        items.forEach((item) => {
          const day = parseInt(item.getAttribute("data-day"), 10);
          const daysLeft = daysUntil(day);
          const whenEl = item.querySelector(".when");
          if (whenEl) whenEl.textContent = formatDueText(daysLeft);
          paymentsTrack.appendChild(item);
        });
      }

      async function refreshUI(sessionOverride) {
        let session = sessionOverride;
        if (sessionOverride === undefined) {
          const { data, error } = await supabaseClient.auth.getSession();
          if (error) setMsg("Session error: " + error.message);
          session = data?.session || null;
        }

        const loggedIn = !!session;

        if (app) app.style.display = loggedIn ? "" : "none";
        if (authSection) authSection.style.display = loggedIn ? "none" : "";
        if (logoutBtn) logoutBtn.style.display = loggedIn ? "" : "none";
        if (signupBtn) signupBtn.style.display = loggedIn ? "none" : "";

        document.body.classList.toggle("auth-only", !loggedIn);
        setMsg(loggedIn ? "Je bent ingelogd." : "");
      }

      // Login
      loginForm?.addEventListener("submit", async (e) => {
        e.preventDefault();
        setMsg("Bezig met inloggen...");

        const email = document.getElementById("email")?.value?.trim();
        const password = document.getElementById("password")?.value;

        const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
        if (error) return setMsg("Inloggen mislukt: " + error.message);

        setMsg("Ingelogd.");
        await refreshUI(data?.session || null);
      });

      // Signup
      signupBtn?.addEventListener("click", async () => {
        setMsg("Account aanmaken...");

        const email = document.getElementById("email")?.value?.trim();
        const password = document.getElementById("password")?.value;

        const { data, error } = await supabaseClient.auth.signUp({ email, password });
        if (error) return setMsg("Account maken mislukt: " + error.message);

        setMsg("Account gemaakt. Probeer nu in te loggen.");
        await refreshUI(data?.session || null);
      });

      // Logout
      logoutBtn?.addEventListener("click", async () => {
        await supabaseClient.auth.signOut({ scope: "local" });
        localStorage.removeItem("sb-cgeescjioqfmjfgdtlnm-auth-token");
        setMsg("Uitgelogd.");
        await refreshUI(null);
      });

      supabaseClient.auth.onAuthStateChange((_event, session) => refreshUI(session));
      sortPayments();
      setTodayDate();
      refreshUI();
    </script>
